{"ast":null,"code":"import { supabaseAnon, supabaseService } from '../supabaseClient';\n\n/**\n * Industry-Standard Company Creation Service\n * Follows exact 3-step workflow as specified\n */\nexport class CompanyService {\n  /**\n   * Step A: Create a New Company\n   * Insert company record with basic info\n   */\n  static async createCompany(companyName) {\n    try {\n      console.log('🏢 Step A: Creating company:', companyName);\n      const {\n        data: company,\n        error\n      } = await supabase.from('companies').insert({\n        name: companyName\n      }).select().single();\n      if (error) {\n        console.error('❌ Error creating company:', error);\n        throw new Error(`Failed to create company: ${error.message}`);\n      }\n      console.log('✅ Company created:', company);\n      return company;\n    } catch (error) {\n      console.error('❌ Company creation failed:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Step B: Create the Owner Auth Account\n   * Use Supabase Admin API to create authenticated user\n   */\n  static async createOwnerAuthAccount(ownerEmail, tempPassword) {\n    try {\n      var _authUser$user;\n      console.log('👤 Step B: Creating owner auth account for:', ownerEmail);\n      const {\n        data: authUser,\n        error: authError\n      } = await supabaseAdmin.auth.admin.createUser({\n        email: ownerEmail,\n        password: tempPassword,\n        email_confirm: true\n      });\n      if (authError) {\n        console.error('❌ Error creating auth user:', authError);\n        throw new Error(`Failed to create auth account: ${authError.message}`);\n      }\n      if (!(authUser !== null && authUser !== void 0 && (_authUser$user = authUser.user) !== null && _authUser$user !== void 0 && _authUser$user.id)) {\n        throw new Error('Auth user creation returned no user ID');\n      }\n      console.log('✅ Auth user created:', authUser.user.email, 'ID:', authUser.user.id);\n      return authUser;\n    } catch (error) {\n      console.error('❌ Auth account creation failed:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Step C: Create the Owner Profile\n   * Insert profile record and update company with owner reference\n   */\n  static async createOwnerProfile(authUserId, companyId, ownerFirstName, ownerLastName, ownerPhone) {\n    try {\n      console.log('📋 Step C: Creating owner profile for user:', authUserId);\n      const fullName = `${ownerFirstName} ${ownerLastName}`;\n\n      // Insert profile record\n      const {\n        data: profile,\n        error: profileError\n      } = await supabase.from('profiles').insert({\n        id: authUserId,\n        company_id: companyId,\n        role: 'OWNER',\n        full_name: fullName,\n        phone: ownerPhone || null\n      }).select().single();\n      if (profileError) {\n        console.error('❌ Error creating profile:', profileError);\n        throw new Error(`Failed to create profile: ${profileError.message}`);\n      }\n      console.log('✅ Profile created:', profile);\n\n      // Note: No need to update companies table with owner_profile_id\n      // as the relationship is maintained via profiles.company_id\n      return profile;\n    } catch (error) {\n      console.error('❌ Owner profile creation failed:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Complete Company Creation Workflow\n   * Executes all 3 steps with proper error handling and rollback\n   */\n  static async createCompanyWithOwner(formData) {\n    const {\n      companyName,\n      ownerFirstName,\n      ownerLastName,\n      ownerEmail,\n      ownerPhone,\n      tempPassword\n    } = formData;\n    let createdCompany = null;\n    let createdAuthUser = null;\n    try {\n      console.log('🚀 Starting complete company creation workflow...');\n\n      // Step A: Create Company\n      createdCompany = await this.createCompany(companyName);\n\n      // Step B: Create Owner Auth Account\n      createdAuthUser = await this.createOwnerAuthAccount(ownerEmail, tempPassword);\n\n      // Step C: Create Owner Profile\n      const createdProfile = await this.createOwnerProfile(createdAuthUser.user.id, createdCompany.id, ownerFirstName, ownerLastName, ownerPhone);\n      console.log('🎉 Company creation workflow completed successfully!');\n      return {\n        company: createdCompany,\n        authUser: createdAuthUser,\n        profile: createdProfile,\n        success: true\n      };\n    } catch (error) {\n      console.error('❌ Company creation workflow failed, attempting rollback...');\n\n      // Rollback: Delete created records\n      try {\n        var _createdAuthUser, _createdAuthUser$user, _createdCompany;\n        if ((_createdAuthUser = createdAuthUser) !== null && _createdAuthUser !== void 0 && (_createdAuthUser$user = _createdAuthUser.user) !== null && _createdAuthUser$user !== void 0 && _createdAuthUser$user.id) {\n          console.log('🔄 Rolling back auth user...');\n          await supabaseAdmin.auth.admin.deleteUser(createdAuthUser.user.id);\n        }\n        if ((_createdCompany = createdCompany) !== null && _createdCompany !== void 0 && _createdCompany.id) {\n          console.log('🔄 Rolling back company...');\n          await supabase.from('companies').delete().eq('id', createdCompany.id);\n        }\n        console.log('✅ Rollback completed');\n      } catch (rollbackError) {\n        console.error('❌ Rollback failed:', rollbackError);\n      }\n      throw error;\n    }\n  }\n\n  /**\n   * Get all companies with owner information and email from auth.users\n   */\n  static async getAllCompanies() {\n    try {\n      // Get companies and find owners via profiles table\n      const {\n        data: companies,\n        error\n      } = await supabase.from('companies').select(`\n          id,\n          name,\n          created_at\n        `).order('created_at', {\n        ascending: false\n      });\n      if (error) {\n        console.error('❌ Error fetching companies:', error);\n        throw error;\n      }\n\n      // For each company, find the owner (profile with role = 'OWNER')\n      const companiesWithOwners = await Promise.all((companies || []).map(async company => {\n        try {\n          // Find owner profile for this company\n          const {\n            data: ownerProfile,\n            error: profileError\n          } = await supabase.from('profiles').select('id, full_name, phone').eq('company_id', company.id).eq('role', 'OWNER').single();\n          if (profileError && profileError.code !== 'PGRST116') {\n            console.error('Error fetching owner profile:', profileError);\n          }\n\n          // Get owner email from auth.users if we have an owner\n          let ownerEmail = 'N/A';\n          if (ownerProfile !== null && ownerProfile !== void 0 && ownerProfile.id) {\n            try {\n              var _authUser$user2;\n              const {\n                data: authUser\n              } = await supabaseAdmin.auth.admin.getUserById(ownerProfile.id);\n              ownerEmail = (authUser === null || authUser === void 0 ? void 0 : (_authUser$user2 = authUser.user) === null || _authUser$user2 === void 0 ? void 0 : _authUser$user2.email) || 'N/A';\n            } catch (error) {\n              console.error('Error fetching owner email:', error);\n            }\n          }\n          return {\n            ...company,\n            owner_profile: ownerProfile,\n            owner_email: ownerEmail\n          };\n        } catch (error) {\n          console.error('Error processing company:', error);\n          return {\n            ...company,\n            owner_profile: null,\n            owner_email: 'N/A'\n          };\n        }\n      }));\n      return companiesWithOwners;\n    } catch (error) {\n      console.error('❌ Failed to fetch companies:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get company details with owner and employees, including emails from auth.users\n   */\n  static async getCompanyDetails(companyId) {\n    try {\n      var _company$owner_profil;\n      const {\n        data: company,\n        error\n      } = await supabase.from('companies').select(`\n          id,\n          name,\n          created_at,\n          owner_profile_id,\n          owner_profile:profiles!owner_profile_id (\n            id,\n            full_name,\n            phone\n          ),\n          employees:profiles!company_id (\n            id,\n            full_name,\n            role,\n            phone,\n            created_at\n          )\n        `).eq('id', companyId).single();\n      if (error) {\n        console.error('❌ Error fetching company details:', error);\n        throw error;\n      }\n\n      // Get owner email\n      let ownerEmail = 'N/A';\n      if ((_company$owner_profil = company.owner_profile) !== null && _company$owner_profil !== void 0 && _company$owner_profil.id) {\n        try {\n          var _authUser$user3;\n          const {\n            data: authUser\n          } = await supabaseAdmin.auth.admin.getUserById(company.owner_profile.id);\n          ownerEmail = (authUser === null || authUser === void 0 ? void 0 : (_authUser$user3 = authUser.user) === null || _authUser$user3 === void 0 ? void 0 : _authUser$user3.email) || 'N/A';\n        } catch (error) {\n          console.error('Error fetching owner email:', error);\n        }\n      }\n\n      // Get employee emails\n      const employeesWithEmails = await Promise.all((company.employees || []).map(async employee => {\n        try {\n          var _authUser$user4;\n          const {\n            data: authUser\n          } = await supabaseAdmin.auth.admin.getUserById(employee.id);\n          return {\n            ...employee,\n            email: (authUser === null || authUser === void 0 ? void 0 : (_authUser$user4 = authUser.user) === null || _authUser$user4 === void 0 ? void 0 : _authUser$user4.email) || 'N/A'\n          };\n        } catch (error) {\n          console.error('Error fetching employee email:', error);\n          return {\n            ...employee,\n            email: 'N/A'\n          };\n        }\n      }));\n      return {\n        ...company,\n        owner_email: ownerEmail,\n        employees: employeesWithEmails\n      };\n    } catch (error) {\n      console.error('❌ Failed to fetch company details:', error);\n      throw error;\n    }\n  }\n}","map":{"version":3,"names":["supabaseAnon","supabaseService","CompanyService","createCompany","companyName","console","log","data","company","error","supabase","from","insert","name","select","single","Error","message","createOwnerAuthAccount","ownerEmail","tempPassword","_authUser$user","authUser","authError","supabaseAdmin","auth","admin","createUser","email","password","email_confirm","user","id","createOwnerProfile","authUserId","companyId","ownerFirstName","ownerLastName","ownerPhone","fullName","profile","profileError","company_id","role","full_name","phone","createCompanyWithOwner","formData","createdCompany","createdAuthUser","createdProfile","success","_createdAuthUser","_createdAuthUser$user","_createdCompany","deleteUser","delete","eq","rollbackError","getAllCompanies","companies","order","ascending","companiesWithOwners","Promise","all","map","ownerProfile","code","_authUser$user2","getUserById","owner_profile","owner_email","getCompanyDetails","_company$owner_profil","_authUser$user3","employeesWithEmails","employees","employee","_authUser$user4"],"sources":["D:/TradeMate Pro Webapp/admin-dashboard/src/services/CompanyService.js"],"sourcesContent":["import { supabaseAnon, supabaseService } from '../supabaseClient';\n\n/**\n * Industry-Standard Company Creation Service\n * Follows exact 3-step workflow as specified\n */\nexport class CompanyService {\n  \n  /**\n   * Step A: Create a New Company\n   * Insert company record with basic info\n   */\n  static async createCompany(companyName) {\n    try {\n      console.log('🏢 Step A: Creating company:', companyName);\n      \n      const { data: company, error } = await supabase\n        .from('companies')\n        .insert({ name: companyName })\n        .select()\n        .single();\n\n      if (error) {\n        console.error('❌ Error creating company:', error);\n        throw new Error(`Failed to create company: ${error.message}`);\n      }\n\n      console.log('✅ Company created:', company);\n      return company;\n    } catch (error) {\n      console.error('❌ Company creation failed:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Step B: Create the Owner Auth Account\n   * Use Supabase Admin API to create authenticated user\n   */\n  static async createOwnerAuthAccount(ownerEmail, tempPassword) {\n    try {\n      console.log('👤 Step B: Creating owner auth account for:', ownerEmail);\n      \n      const { data: authUser, error: authError } = await supabaseAdmin.auth.admin.createUser({\n        email: ownerEmail,\n        password: tempPassword,\n        email_confirm: true,\n      });\n\n      if (authError) {\n        console.error('❌ Error creating auth user:', authError);\n        throw new Error(`Failed to create auth account: ${authError.message}`);\n      }\n\n      if (!authUser?.user?.id) {\n        throw new Error('Auth user creation returned no user ID');\n      }\n\n      console.log('✅ Auth user created:', authUser.user.email, 'ID:', authUser.user.id);\n      return authUser;\n    } catch (error) {\n      console.error('❌ Auth account creation failed:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Step C: Create the Owner Profile\n   * Insert profile record and update company with owner reference\n   */\n  static async createOwnerProfile(authUserId, companyId, ownerFirstName, ownerLastName, ownerPhone) {\n    try {\n      console.log('📋 Step C: Creating owner profile for user:', authUserId);\n      \n      const fullName = `${ownerFirstName} ${ownerLastName}`;\n      \n      // Insert profile record\n      const { data: profile, error: profileError } = await supabase\n        .from('profiles')\n        .insert({\n          id: authUserId,\n          company_id: companyId,\n          role: 'OWNER',\n          full_name: fullName,\n          phone: ownerPhone || null,\n        })\n        .select()\n        .single();\n\n      if (profileError) {\n        console.error('❌ Error creating profile:', profileError);\n        throw new Error(`Failed to create profile: ${profileError.message}`);\n      }\n\n      console.log('✅ Profile created:', profile);\n\n      // Note: No need to update companies table with owner_profile_id\n      // as the relationship is maintained via profiles.company_id\n      return profile;\n    } catch (error) {\n      console.error('❌ Owner profile creation failed:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Complete Company Creation Workflow\n   * Executes all 3 steps with proper error handling and rollback\n   */\n  static async createCompanyWithOwner(formData) {\n    const { companyName, ownerFirstName, ownerLastName, ownerEmail, ownerPhone, tempPassword } = formData;\n    \n    let createdCompany = null;\n    let createdAuthUser = null;\n    \n    try {\n      console.log('🚀 Starting complete company creation workflow...');\n      \n      // Step A: Create Company\n      createdCompany = await this.createCompany(companyName);\n      \n      // Step B: Create Owner Auth Account\n      createdAuthUser = await this.createOwnerAuthAccount(ownerEmail, tempPassword);\n      \n      // Step C: Create Owner Profile\n      const createdProfile = await this.createOwnerProfile(\n        createdAuthUser.user.id,\n        createdCompany.id,\n        ownerFirstName,\n        ownerLastName,\n        ownerPhone\n      );\n\n      console.log('🎉 Company creation workflow completed successfully!');\n      \n      return {\n        company: createdCompany,\n        authUser: createdAuthUser,\n        profile: createdProfile,\n        success: true\n      };\n      \n    } catch (error) {\n      console.error('❌ Company creation workflow failed, attempting rollback...');\n      \n      // Rollback: Delete created records\n      try {\n        if (createdAuthUser?.user?.id) {\n          console.log('🔄 Rolling back auth user...');\n          await supabaseAdmin.auth.admin.deleteUser(createdAuthUser.user.id);\n        }\n        \n        if (createdCompany?.id) {\n          console.log('🔄 Rolling back company...');\n          await supabase.from('companies').delete().eq('id', createdCompany.id);\n        }\n        \n        console.log('✅ Rollback completed');\n      } catch (rollbackError) {\n        console.error('❌ Rollback failed:', rollbackError);\n      }\n      \n      throw error;\n    }\n  }\n\n  /**\n   * Get all companies with owner information and email from auth.users\n   */\n  static async getAllCompanies() {\n    try {\n      // Get companies and find owners via profiles table\n      const { data: companies, error } = await supabase\n        .from('companies')\n        .select(`\n          id,\n          name,\n          created_at\n        `)\n        .order('created_at', { ascending: false });\n\n      if (error) {\n        console.error('❌ Error fetching companies:', error);\n        throw error;\n      }\n\n      // For each company, find the owner (profile with role = 'OWNER')\n      const companiesWithOwners = await Promise.all(\n        (companies || []).map(async (company) => {\n          try {\n            // Find owner profile for this company\n            const { data: ownerProfile, error: profileError } = await supabase\n              .from('profiles')\n              .select('id, full_name, phone')\n              .eq('company_id', company.id)\n              .eq('role', 'OWNER')\n              .single();\n\n            if (profileError && profileError.code !== 'PGRST116') {\n              console.error('Error fetching owner profile:', profileError);\n            }\n\n            // Get owner email from auth.users if we have an owner\n            let ownerEmail = 'N/A';\n            if (ownerProfile?.id) {\n              try {\n                const { data: authUser } = await supabaseAdmin.auth.admin.getUserById(ownerProfile.id);\n                ownerEmail = authUser?.user?.email || 'N/A';\n              } catch (error) {\n                console.error('Error fetching owner email:', error);\n              }\n            }\n\n            return {\n              ...company,\n              owner_profile: ownerProfile,\n              owner_email: ownerEmail\n            };\n          } catch (error) {\n            console.error('Error processing company:', error);\n            return {\n              ...company,\n              owner_profile: null,\n              owner_email: 'N/A'\n            };\n          }\n        })\n      );\n\n      return companiesWithOwners;\n    } catch (error) {\n      console.error('❌ Failed to fetch companies:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get company details with owner and employees, including emails from auth.users\n   */\n  static async getCompanyDetails(companyId) {\n    try {\n      const { data: company, error } = await supabase\n        .from('companies')\n        .select(`\n          id,\n          name,\n          created_at,\n          owner_profile_id,\n          owner_profile:profiles!owner_profile_id (\n            id,\n            full_name,\n            phone\n          ),\n          employees:profiles!company_id (\n            id,\n            full_name,\n            role,\n            phone,\n            created_at\n          )\n        `)\n        .eq('id', companyId)\n        .single();\n\n      if (error) {\n        console.error('❌ Error fetching company details:', error);\n        throw error;\n      }\n\n      // Get owner email\n      let ownerEmail = 'N/A';\n      if (company.owner_profile?.id) {\n        try {\n          const { data: authUser } = await supabaseAdmin.auth.admin.getUserById(company.owner_profile.id);\n          ownerEmail = authUser?.user?.email || 'N/A';\n        } catch (error) {\n          console.error('Error fetching owner email:', error);\n        }\n      }\n\n      // Get employee emails\n      const employeesWithEmails = await Promise.all(\n        (company.employees || []).map(async (employee) => {\n          try {\n            const { data: authUser } = await supabaseAdmin.auth.admin.getUserById(employee.id);\n            return {\n              ...employee,\n              email: authUser?.user?.email || 'N/A'\n            };\n          } catch (error) {\n            console.error('Error fetching employee email:', error);\n            return {\n              ...employee,\n              email: 'N/A'\n            };\n          }\n        })\n      );\n\n      return {\n        ...company,\n        owner_email: ownerEmail,\n        employees: employeesWithEmails\n      };\n    } catch (error) {\n      console.error('❌ Failed to fetch company details:', error);\n      throw error;\n    }\n  }\n}\n"],"mappings":"AAAA,SAASA,YAAY,EAAEC,eAAe,QAAQ,mBAAmB;;AAEjE;AACA;AACA;AACA;AACA,OAAO,MAAMC,cAAc,CAAC;EAE1B;AACF;AACA;AACA;EACE,aAAaC,aAAaA,CAACC,WAAW,EAAE;IACtC,IAAI;MACFC,OAAO,CAACC,GAAG,CAAC,8BAA8B,EAAEF,WAAW,CAAC;MAExD,MAAM;QAAEG,IAAI,EAAEC,OAAO;QAAEC;MAAM,CAAC,GAAG,MAAMC,QAAQ,CAC5CC,IAAI,CAAC,WAAW,CAAC,CACjBC,MAAM,CAAC;QAAEC,IAAI,EAAET;MAAY,CAAC,CAAC,CAC7BU,MAAM,CAAC,CAAC,CACRC,MAAM,CAAC,CAAC;MAEX,IAAIN,KAAK,EAAE;QACTJ,OAAO,CAACI,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;QACjD,MAAM,IAAIO,KAAK,CAAC,6BAA6BP,KAAK,CAACQ,OAAO,EAAE,CAAC;MAC/D;MAEAZ,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAEE,OAAO,CAAC;MAC1C,OAAOA,OAAO;IAChB,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdJ,OAAO,CAACI,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;MAClD,MAAMA,KAAK;IACb;EACF;;EAEA;AACF;AACA;AACA;EACE,aAAaS,sBAAsBA,CAACC,UAAU,EAAEC,YAAY,EAAE;IAC5D,IAAI;MAAA,IAAAC,cAAA;MACFhB,OAAO,CAACC,GAAG,CAAC,6CAA6C,EAAEa,UAAU,CAAC;MAEtE,MAAM;QAAEZ,IAAI,EAAEe,QAAQ;QAAEb,KAAK,EAAEc;MAAU,CAAC,GAAG,MAAMC,aAAa,CAACC,IAAI,CAACC,KAAK,CAACC,UAAU,CAAC;QACrFC,KAAK,EAAET,UAAU;QACjBU,QAAQ,EAAET,YAAY;QACtBU,aAAa,EAAE;MACjB,CAAC,CAAC;MAEF,IAAIP,SAAS,EAAE;QACblB,OAAO,CAACI,KAAK,CAAC,6BAA6B,EAAEc,SAAS,CAAC;QACvD,MAAM,IAAIP,KAAK,CAAC,kCAAkCO,SAAS,CAACN,OAAO,EAAE,CAAC;MACxE;MAEA,IAAI,EAACK,QAAQ,aAARA,QAAQ,gBAAAD,cAAA,GAARC,QAAQ,CAAES,IAAI,cAAAV,cAAA,eAAdA,cAAA,CAAgBW,EAAE,GAAE;QACvB,MAAM,IAAIhB,KAAK,CAAC,wCAAwC,CAAC;MAC3D;MAEAX,OAAO,CAACC,GAAG,CAAC,sBAAsB,EAAEgB,QAAQ,CAACS,IAAI,CAACH,KAAK,EAAE,KAAK,EAAEN,QAAQ,CAACS,IAAI,CAACC,EAAE,CAAC;MACjF,OAAOV,QAAQ;IACjB,CAAC,CAAC,OAAOb,KAAK,EAAE;MACdJ,OAAO,CAACI,KAAK,CAAC,iCAAiC,EAAEA,KAAK,CAAC;MACvD,MAAMA,KAAK;IACb;EACF;;EAEA;AACF;AACA;AACA;EACE,aAAawB,kBAAkBA,CAACC,UAAU,EAAEC,SAAS,EAAEC,cAAc,EAAEC,aAAa,EAAEC,UAAU,EAAE;IAChG,IAAI;MACFjC,OAAO,CAACC,GAAG,CAAC,6CAA6C,EAAE4B,UAAU,CAAC;MAEtE,MAAMK,QAAQ,GAAG,GAAGH,cAAc,IAAIC,aAAa,EAAE;;MAErD;MACA,MAAM;QAAE9B,IAAI,EAAEiC,OAAO;QAAE/B,KAAK,EAAEgC;MAAa,CAAC,GAAG,MAAM/B,QAAQ,CAC1DC,IAAI,CAAC,UAAU,CAAC,CAChBC,MAAM,CAAC;QACNoB,EAAE,EAAEE,UAAU;QACdQ,UAAU,EAAEP,SAAS;QACrBQ,IAAI,EAAE,OAAO;QACbC,SAAS,EAAEL,QAAQ;QACnBM,KAAK,EAAEP,UAAU,IAAI;MACvB,CAAC,CAAC,CACDxB,MAAM,CAAC,CAAC,CACRC,MAAM,CAAC,CAAC;MAEX,IAAI0B,YAAY,EAAE;QAChBpC,OAAO,CAACI,KAAK,CAAC,2BAA2B,EAAEgC,YAAY,CAAC;QACxD,MAAM,IAAIzB,KAAK,CAAC,6BAA6ByB,YAAY,CAACxB,OAAO,EAAE,CAAC;MACtE;MAEAZ,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAEkC,OAAO,CAAC;;MAE1C;MACA;MACA,OAAOA,OAAO;IAChB,CAAC,CAAC,OAAO/B,KAAK,EAAE;MACdJ,OAAO,CAACI,KAAK,CAAC,kCAAkC,EAAEA,KAAK,CAAC;MACxD,MAAMA,KAAK;IACb;EACF;;EAEA;AACF;AACA;AACA;EACE,aAAaqC,sBAAsBA,CAACC,QAAQ,EAAE;IAC5C,MAAM;MAAE3C,WAAW;MAAEgC,cAAc;MAAEC,aAAa;MAAElB,UAAU;MAAEmB,UAAU;MAAElB;IAAa,CAAC,GAAG2B,QAAQ;IAErG,IAAIC,cAAc,GAAG,IAAI;IACzB,IAAIC,eAAe,GAAG,IAAI;IAE1B,IAAI;MACF5C,OAAO,CAACC,GAAG,CAAC,mDAAmD,CAAC;;MAEhE;MACA0C,cAAc,GAAG,MAAM,IAAI,CAAC7C,aAAa,CAACC,WAAW,CAAC;;MAEtD;MACA6C,eAAe,GAAG,MAAM,IAAI,CAAC/B,sBAAsB,CAACC,UAAU,EAAEC,YAAY,CAAC;;MAE7E;MACA,MAAM8B,cAAc,GAAG,MAAM,IAAI,CAACjB,kBAAkB,CAClDgB,eAAe,CAAClB,IAAI,CAACC,EAAE,EACvBgB,cAAc,CAAChB,EAAE,EACjBI,cAAc,EACdC,aAAa,EACbC,UACF,CAAC;MAEDjC,OAAO,CAACC,GAAG,CAAC,sDAAsD,CAAC;MAEnE,OAAO;QACLE,OAAO,EAAEwC,cAAc;QACvB1B,QAAQ,EAAE2B,eAAe;QACzBT,OAAO,EAAEU,cAAc;QACvBC,OAAO,EAAE;MACX,CAAC;IAEH,CAAC,CAAC,OAAO1C,KAAK,EAAE;MACdJ,OAAO,CAACI,KAAK,CAAC,4DAA4D,CAAC;;MAE3E;MACA,IAAI;QAAA,IAAA2C,gBAAA,EAAAC,qBAAA,EAAAC,eAAA;QACF,KAAAF,gBAAA,GAAIH,eAAe,cAAAG,gBAAA,gBAAAC,qBAAA,GAAfD,gBAAA,CAAiBrB,IAAI,cAAAsB,qBAAA,eAArBA,qBAAA,CAAuBrB,EAAE,EAAE;UAC7B3B,OAAO,CAACC,GAAG,CAAC,8BAA8B,CAAC;UAC3C,MAAMkB,aAAa,CAACC,IAAI,CAACC,KAAK,CAAC6B,UAAU,CAACN,eAAe,CAAClB,IAAI,CAACC,EAAE,CAAC;QACpE;QAEA,KAAAsB,eAAA,GAAIN,cAAc,cAAAM,eAAA,eAAdA,eAAA,CAAgBtB,EAAE,EAAE;UACtB3B,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAC;UACzC,MAAMI,QAAQ,CAACC,IAAI,CAAC,WAAW,CAAC,CAAC6C,MAAM,CAAC,CAAC,CAACC,EAAE,CAAC,IAAI,EAAET,cAAc,CAAChB,EAAE,CAAC;QACvE;QAEA3B,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAC;MACrC,CAAC,CAAC,OAAOoD,aAAa,EAAE;QACtBrD,OAAO,CAACI,KAAK,CAAC,oBAAoB,EAAEiD,aAAa,CAAC;MACpD;MAEA,MAAMjD,KAAK;IACb;EACF;;EAEA;AACF;AACA;EACE,aAAakD,eAAeA,CAAA,EAAG;IAC7B,IAAI;MACF;MACA,MAAM;QAAEpD,IAAI,EAAEqD,SAAS;QAAEnD;MAAM,CAAC,GAAG,MAAMC,QAAQ,CAC9CC,IAAI,CAAC,WAAW,CAAC,CACjBG,MAAM,CAAC;AAChB;AACA;AACA;AACA,SAAS,CAAC,CACD+C,KAAK,CAAC,YAAY,EAAE;QAAEC,SAAS,EAAE;MAAM,CAAC,CAAC;MAE5C,IAAIrD,KAAK,EAAE;QACTJ,OAAO,CAACI,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;QACnD,MAAMA,KAAK;MACb;;MAEA;MACA,MAAMsD,mBAAmB,GAAG,MAAMC,OAAO,CAACC,GAAG,CAC3C,CAACL,SAAS,IAAI,EAAE,EAAEM,GAAG,CAAC,MAAO1D,OAAO,IAAK;QACvC,IAAI;UACF;UACA,MAAM;YAAED,IAAI,EAAE4D,YAAY;YAAE1D,KAAK,EAAEgC;UAAa,CAAC,GAAG,MAAM/B,QAAQ,CAC/DC,IAAI,CAAC,UAAU,CAAC,CAChBG,MAAM,CAAC,sBAAsB,CAAC,CAC9B2C,EAAE,CAAC,YAAY,EAAEjD,OAAO,CAACwB,EAAE,CAAC,CAC5ByB,EAAE,CAAC,MAAM,EAAE,OAAO,CAAC,CACnB1C,MAAM,CAAC,CAAC;UAEX,IAAI0B,YAAY,IAAIA,YAAY,CAAC2B,IAAI,KAAK,UAAU,EAAE;YACpD/D,OAAO,CAACI,KAAK,CAAC,+BAA+B,EAAEgC,YAAY,CAAC;UAC9D;;UAEA;UACA,IAAItB,UAAU,GAAG,KAAK;UACtB,IAAIgD,YAAY,aAAZA,YAAY,eAAZA,YAAY,CAAEnC,EAAE,EAAE;YACpB,IAAI;cAAA,IAAAqC,eAAA;cACF,MAAM;gBAAE9D,IAAI,EAAEe;cAAS,CAAC,GAAG,MAAME,aAAa,CAACC,IAAI,CAACC,KAAK,CAAC4C,WAAW,CAACH,YAAY,CAACnC,EAAE,CAAC;cACtFb,UAAU,GAAG,CAAAG,QAAQ,aAARA,QAAQ,wBAAA+C,eAAA,GAAR/C,QAAQ,CAAES,IAAI,cAAAsC,eAAA,uBAAdA,eAAA,CAAgBzC,KAAK,KAAI,KAAK;YAC7C,CAAC,CAAC,OAAOnB,KAAK,EAAE;cACdJ,OAAO,CAACI,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;YACrD;UACF;UAEA,OAAO;YACL,GAAGD,OAAO;YACV+D,aAAa,EAAEJ,YAAY;YAC3BK,WAAW,EAAErD;UACf,CAAC;QACH,CAAC,CAAC,OAAOV,KAAK,EAAE;UACdJ,OAAO,CAACI,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;UACjD,OAAO;YACL,GAAGD,OAAO;YACV+D,aAAa,EAAE,IAAI;YACnBC,WAAW,EAAE;UACf,CAAC;QACH;MACF,CAAC,CACH,CAAC;MAED,OAAOT,mBAAmB;IAC5B,CAAC,CAAC,OAAOtD,KAAK,EAAE;MACdJ,OAAO,CAACI,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;MACpD,MAAMA,KAAK;IACb;EACF;;EAEA;AACF;AACA;EACE,aAAagE,iBAAiBA,CAACtC,SAAS,EAAE;IACxC,IAAI;MAAA,IAAAuC,qBAAA;MACF,MAAM;QAAEnE,IAAI,EAAEC,OAAO;QAAEC;MAAM,CAAC,GAAG,MAAMC,QAAQ,CAC5CC,IAAI,CAAC,WAAW,CAAC,CACjBG,MAAM,CAAC;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,CAAC,CACD2C,EAAE,CAAC,IAAI,EAAEtB,SAAS,CAAC,CACnBpB,MAAM,CAAC,CAAC;MAEX,IAAIN,KAAK,EAAE;QACTJ,OAAO,CAACI,KAAK,CAAC,mCAAmC,EAAEA,KAAK,CAAC;QACzD,MAAMA,KAAK;MACb;;MAEA;MACA,IAAIU,UAAU,GAAG,KAAK;MACtB,KAAAuD,qBAAA,GAAIlE,OAAO,CAAC+D,aAAa,cAAAG,qBAAA,eAArBA,qBAAA,CAAuB1C,EAAE,EAAE;QAC7B,IAAI;UAAA,IAAA2C,eAAA;UACF,MAAM;YAAEpE,IAAI,EAAEe;UAAS,CAAC,GAAG,MAAME,aAAa,CAACC,IAAI,CAACC,KAAK,CAAC4C,WAAW,CAAC9D,OAAO,CAAC+D,aAAa,CAACvC,EAAE,CAAC;UAC/Fb,UAAU,GAAG,CAAAG,QAAQ,aAARA,QAAQ,wBAAAqD,eAAA,GAARrD,QAAQ,CAAES,IAAI,cAAA4C,eAAA,uBAAdA,eAAA,CAAgB/C,KAAK,KAAI,KAAK;QAC7C,CAAC,CAAC,OAAOnB,KAAK,EAAE;UACdJ,OAAO,CAACI,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;QACrD;MACF;;MAEA;MACA,MAAMmE,mBAAmB,GAAG,MAAMZ,OAAO,CAACC,GAAG,CAC3C,CAACzD,OAAO,CAACqE,SAAS,IAAI,EAAE,EAAEX,GAAG,CAAC,MAAOY,QAAQ,IAAK;QAChD,IAAI;UAAA,IAAAC,eAAA;UACF,MAAM;YAAExE,IAAI,EAAEe;UAAS,CAAC,GAAG,MAAME,aAAa,CAACC,IAAI,CAACC,KAAK,CAAC4C,WAAW,CAACQ,QAAQ,CAAC9C,EAAE,CAAC;UAClF,OAAO;YACL,GAAG8C,QAAQ;YACXlD,KAAK,EAAE,CAAAN,QAAQ,aAARA,QAAQ,wBAAAyD,eAAA,GAARzD,QAAQ,CAAES,IAAI,cAAAgD,eAAA,uBAAdA,eAAA,CAAgBnD,KAAK,KAAI;UAClC,CAAC;QACH,CAAC,CAAC,OAAOnB,KAAK,EAAE;UACdJ,OAAO,CAACI,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;UACtD,OAAO;YACL,GAAGqE,QAAQ;YACXlD,KAAK,EAAE;UACT,CAAC;QACH;MACF,CAAC,CACH,CAAC;MAED,OAAO;QACL,GAAGpB,OAAO;QACVgE,WAAW,EAAErD,UAAU;QACvB0D,SAAS,EAAED;MACb,CAAC;IACH,CAAC,CAAC,OAAOnE,KAAK,EAAE;MACdJ,OAAO,CAACI,KAAK,CAAC,oCAAoC,EAAEA,KAAK,CAAC;MAC1D,MAAMA,KAAK;IACb;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}