{"ast":null,"code":"import { supabaseAnon, supabaseService } from '../supabaseClient';\n\n/**\n * Industry-Standard Company Creation Service\n * Follows exact 3-step workflow as specified\n */\nexport class CompanyService {\n  /**\n   * Step A: Create a New Company\n   * Insert company record with basic info\n   */\n  static async createCompany(companyName) {\n    try {\n      console.log('🏢 Step A: Creating company:', companyName);\n      const {\n        data: company,\n        error\n      } = await supabaseService.from('companies').insert({\n        name: companyName\n      }).select().single();\n      if (error) {\n        console.error('❌ Error creating company:', error);\n        throw new Error(`Failed to create company: ${error.message}`);\n      }\n      console.log('✅ Company created:', company);\n      return company;\n    } catch (error) {\n      console.error('❌ Company creation failed:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Step B: Create the Owner Auth Account\n   * Use Supabase Admin API to create authenticated user\n   */\n  static async createOwnerAuthAccount(ownerEmail, tempPassword) {\n    try {\n      var _authUser$user;\n      console.log('👤 Step B: Creating owner auth account for:', ownerEmail);\n      const {\n        data: authUser,\n        error: authError\n      } = await supabaseService.auth.admin.createUser({\n        email: ownerEmail,\n        password: tempPassword,\n        email_confirm: true\n      });\n      if (authError) {\n        console.error('❌ Error creating auth user:', authError);\n        throw new Error(`Failed to create auth account: ${authError.message}`);\n      }\n      if (!(authUser !== null && authUser !== void 0 && (_authUser$user = authUser.user) !== null && _authUser$user !== void 0 && _authUser$user.id)) {\n        throw new Error('Auth user creation returned no user ID');\n      }\n      console.log('✅ Auth user created:', authUser.user.email, 'ID:', authUser.user.id);\n      return authUser;\n    } catch (error) {\n      console.error('❌ Auth account creation failed:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Step C: Create the Owner Profile\n   * Insert profile record using SERVICE KEY (critical!)\n   */\n  static async createOwnerProfile(authUserId, companyId, ownerFirstName, ownerLastName, ownerPhone) {\n    try {\n      console.log('📋 Step C: Creating owner profile for user:', authUserId);\n      const fullName = `${ownerFirstName} ${ownerLastName}`;\n\n      // Insert profile record - MUST use service key for profiles table\n      const {\n        data: profile,\n        error: profileError\n      } = await supabaseService.from('profiles').insert({\n        id: authUserId,\n        company_id: companyId,\n        role: 'OWNER',\n        full_name: fullName,\n        phone: ownerPhone || null\n      }).select().single();\n      if (profileError) {\n        console.error('❌ Error creating profile:', profileError);\n        throw new Error(`Failed to create profile: ${profileError.message}`);\n      }\n      console.log('✅ Profile created:', profile);\n      return profile;\n    } catch (error) {\n      console.error('❌ Owner profile creation failed:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Complete Company Creation Workflow\n   * Executes all 3 steps with proper error handling and rollback\n   */\n  static async createCompanyWithOwner(formData) {\n    const {\n      companyName,\n      ownerFirstName,\n      ownerLastName,\n      ownerEmail,\n      ownerPhone,\n      tempPassword\n    } = formData;\n    let createdCompany = null;\n    let createdAuthUser = null;\n    try {\n      console.log('🚀 Starting complete company creation workflow...');\n\n      // Step A: Create Company\n      createdCompany = await this.createCompany(companyName);\n\n      // Step B: Create Owner Auth Account\n      createdAuthUser = await this.createOwnerAuthAccount(ownerEmail, tempPassword);\n\n      // Step C: Create Owner Profile\n      const createdProfile = await this.createOwnerProfile(createdAuthUser.user.id, createdCompany.id, ownerFirstName, ownerLastName, ownerPhone);\n      console.log('🎉 Company creation workflow completed successfully!');\n      return {\n        company: createdCompany,\n        authUser: createdAuthUser,\n        profile: createdProfile,\n        success: true\n      };\n    } catch (error) {\n      console.error('❌ Company creation workflow failed, attempting rollback...');\n\n      // Rollback: Delete created records\n      try {\n        var _createdAuthUser, _createdAuthUser$user, _createdCompany;\n        if ((_createdAuthUser = createdAuthUser) !== null && _createdAuthUser !== void 0 && (_createdAuthUser$user = _createdAuthUser.user) !== null && _createdAuthUser$user !== void 0 && _createdAuthUser$user.id) {\n          console.log('🔄 Rolling back auth user...');\n          await supabaseService.auth.admin.deleteUser(createdAuthUser.user.id);\n        }\n        if ((_createdCompany = createdCompany) !== null && _createdCompany !== void 0 && _createdCompany.id) {\n          console.log('🔄 Rolling back company...');\n          await supabaseService.from('companies').delete().eq('id', createdCompany.id);\n        }\n        console.log('✅ Rollback completed');\n      } catch (rollbackError) {\n        console.error('❌ Rollback failed:', rollbackError);\n      }\n      throw error;\n    }\n  }\n\n  /**\n   * Get all companies with owner information and email from auth.users\n   */\n  static async getAllCompanies() {\n    try {\n      // Get companies and find owners via profiles table\n      const {\n        data: companies,\n        error\n      } = await supabase.from('companies').select(`\n          id,\n          name,\n          created_at\n        `).order('created_at', {\n        ascending: false\n      });\n      if (error) {\n        console.error('❌ Error fetching companies:', error);\n        throw error;\n      }\n\n      // For each company, find the owner (profile with role = 'OWNER')\n      const companiesWithOwners = await Promise.all((companies || []).map(async company => {\n        try {\n          // Find owner profile for this company\n          const {\n            data: ownerProfile,\n            error: profileError\n          } = await supabase.from('profiles').select('id, full_name, phone').eq('company_id', company.id).eq('role', 'OWNER').single();\n          if (profileError && profileError.code !== 'PGRST116') {\n            console.error('Error fetching owner profile:', profileError);\n          }\n\n          // Get owner email from auth.users if we have an owner\n          let ownerEmail = 'N/A';\n          if (ownerProfile !== null && ownerProfile !== void 0 && ownerProfile.id) {\n            try {\n              var _authUser$user2;\n              const {\n                data: authUser\n              } = await supabaseAdmin.auth.admin.getUserById(ownerProfile.id);\n              ownerEmail = (authUser === null || authUser === void 0 ? void 0 : (_authUser$user2 = authUser.user) === null || _authUser$user2 === void 0 ? void 0 : _authUser$user2.email) || 'N/A';\n            } catch (error) {\n              console.error('Error fetching owner email:', error);\n            }\n          }\n          return {\n            ...company,\n            owner_profile: ownerProfile,\n            owner_email: ownerEmail\n          };\n        } catch (error) {\n          console.error('Error processing company:', error);\n          return {\n            ...company,\n            owner_profile: null,\n            owner_email: 'N/A'\n          };\n        }\n      }));\n      return companiesWithOwners;\n    } catch (error) {\n      console.error('❌ Failed to fetch companies:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get company details with owner and employees, including emails from auth.users\n   */\n  static async getCompanyDetails(companyId) {\n    try {\n      var _company$owner_profil;\n      const {\n        data: company,\n        error\n      } = await supabase.from('companies').select(`\n          id,\n          name,\n          created_at,\n          owner_profile_id,\n          owner_profile:profiles!owner_profile_id (\n            id,\n            full_name,\n            phone\n          ),\n          employees:profiles!company_id (\n            id,\n            full_name,\n            role,\n            phone,\n            created_at\n          )\n        `).eq('id', companyId).single();\n      if (error) {\n        console.error('❌ Error fetching company details:', error);\n        throw error;\n      }\n\n      // Get owner email\n      let ownerEmail = 'N/A';\n      if ((_company$owner_profil = company.owner_profile) !== null && _company$owner_profil !== void 0 && _company$owner_profil.id) {\n        try {\n          var _authUser$user3;\n          const {\n            data: authUser\n          } = await supabaseAdmin.auth.admin.getUserById(company.owner_profile.id);\n          ownerEmail = (authUser === null || authUser === void 0 ? void 0 : (_authUser$user3 = authUser.user) === null || _authUser$user3 === void 0 ? void 0 : _authUser$user3.email) || 'N/A';\n        } catch (error) {\n          console.error('Error fetching owner email:', error);\n        }\n      }\n\n      // Get employee emails\n      const employeesWithEmails = await Promise.all((company.employees || []).map(async employee => {\n        try {\n          var _authUser$user4;\n          const {\n            data: authUser\n          } = await supabaseAdmin.auth.admin.getUserById(employee.id);\n          return {\n            ...employee,\n            email: (authUser === null || authUser === void 0 ? void 0 : (_authUser$user4 = authUser.user) === null || _authUser$user4 === void 0 ? void 0 : _authUser$user4.email) || 'N/A'\n          };\n        } catch (error) {\n          console.error('Error fetching employee email:', error);\n          return {\n            ...employee,\n            email: 'N/A'\n          };\n        }\n      }));\n      return {\n        ...company,\n        owner_email: ownerEmail,\n        employees: employeesWithEmails\n      };\n    } catch (error) {\n      console.error('❌ Failed to fetch company details:', error);\n      throw error;\n    }\n  }\n}","map":{"version":3,"names":["supabaseAnon","supabaseService","CompanyService","createCompany","companyName","console","log","data","company","error","from","insert","name","select","single","Error","message","createOwnerAuthAccount","ownerEmail","tempPassword","_authUser$user","authUser","authError","auth","admin","createUser","email","password","email_confirm","user","id","createOwnerProfile","authUserId","companyId","ownerFirstName","ownerLastName","ownerPhone","fullName","profile","profileError","company_id","role","full_name","phone","createCompanyWithOwner","formData","createdCompany","createdAuthUser","createdProfile","success","_createdAuthUser","_createdAuthUser$user","_createdCompany","deleteUser","delete","eq","rollbackError","getAllCompanies","companies","supabase","order","ascending","companiesWithOwners","Promise","all","map","ownerProfile","code","_authUser$user2","supabaseAdmin","getUserById","owner_profile","owner_email","getCompanyDetails","_company$owner_profil","_authUser$user3","employeesWithEmails","employees","employee","_authUser$user4"],"sources":["D:/TradeMate Pro Webapp/admin-dashboard/src/services/CompanyService.js"],"sourcesContent":["import { supabaseAnon, supabaseService } from '../supabaseClient';\n\n/**\n * Industry-Standard Company Creation Service\n * Follows exact 3-step workflow as specified\n */\nexport class CompanyService {\n  \n  /**\n   * Step A: Create a New Company\n   * Insert company record with basic info\n   */\n  static async createCompany(companyName) {\n    try {\n      console.log('🏢 Step A: Creating company:', companyName);\n\n      const { data: company, error } = await supabaseService\n        .from('companies')\n        .insert({ name: companyName })\n        .select()\n        .single();\n\n      if (error) {\n        console.error('❌ Error creating company:', error);\n        throw new Error(`Failed to create company: ${error.message}`);\n      }\n\n      console.log('✅ Company created:', company);\n      return company;\n    } catch (error) {\n      console.error('❌ Company creation failed:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Step B: Create the Owner Auth Account\n   * Use Supabase Admin API to create authenticated user\n   */\n  static async createOwnerAuthAccount(ownerEmail, tempPassword) {\n    try {\n      console.log('👤 Step B: Creating owner auth account for:', ownerEmail);\n\n      const { data: authUser, error: authError } = await supabaseService.auth.admin.createUser({\n        email: ownerEmail,\n        password: tempPassword,\n        email_confirm: true,\n      });\n\n      if (authError) {\n        console.error('❌ Error creating auth user:', authError);\n        throw new Error(`Failed to create auth account: ${authError.message}`);\n      }\n\n      if (!authUser?.user?.id) {\n        throw new Error('Auth user creation returned no user ID');\n      }\n\n      console.log('✅ Auth user created:', authUser.user.email, 'ID:', authUser.user.id);\n      return authUser;\n    } catch (error) {\n      console.error('❌ Auth account creation failed:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Step C: Create the Owner Profile\n   * Insert profile record using SERVICE KEY (critical!)\n   */\n  static async createOwnerProfile(authUserId, companyId, ownerFirstName, ownerLastName, ownerPhone) {\n    try {\n      console.log('📋 Step C: Creating owner profile for user:', authUserId);\n\n      const fullName = `${ownerFirstName} ${ownerLastName}`;\n\n      // Insert profile record - MUST use service key for profiles table\n      const { data: profile, error: profileError } = await supabaseService\n        .from('profiles')\n        .insert({\n          id: authUserId,\n          company_id: companyId,\n          role: 'OWNER',\n          full_name: fullName,\n          phone: ownerPhone || null,\n        })\n        .select()\n        .single();\n\n      if (profileError) {\n        console.error('❌ Error creating profile:', profileError);\n        throw new Error(`Failed to create profile: ${profileError.message}`);\n      }\n\n      console.log('✅ Profile created:', profile);\n      return profile;\n    } catch (error) {\n      console.error('❌ Owner profile creation failed:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Complete Company Creation Workflow\n   * Executes all 3 steps with proper error handling and rollback\n   */\n  static async createCompanyWithOwner(formData) {\n    const { companyName, ownerFirstName, ownerLastName, ownerEmail, ownerPhone, tempPassword } = formData;\n    \n    let createdCompany = null;\n    let createdAuthUser = null;\n    \n    try {\n      console.log('🚀 Starting complete company creation workflow...');\n      \n      // Step A: Create Company\n      createdCompany = await this.createCompany(companyName);\n      \n      // Step B: Create Owner Auth Account\n      createdAuthUser = await this.createOwnerAuthAccount(ownerEmail, tempPassword);\n      \n      // Step C: Create Owner Profile\n      const createdProfile = await this.createOwnerProfile(\n        createdAuthUser.user.id,\n        createdCompany.id,\n        ownerFirstName,\n        ownerLastName,\n        ownerPhone\n      );\n\n      console.log('🎉 Company creation workflow completed successfully!');\n      \n      return {\n        company: createdCompany,\n        authUser: createdAuthUser,\n        profile: createdProfile,\n        success: true\n      };\n      \n    } catch (error) {\n      console.error('❌ Company creation workflow failed, attempting rollback...');\n      \n      // Rollback: Delete created records\n      try {\n        if (createdAuthUser?.user?.id) {\n          console.log('🔄 Rolling back auth user...');\n          await supabaseService.auth.admin.deleteUser(createdAuthUser.user.id);\n        }\n\n        if (createdCompany?.id) {\n          console.log('🔄 Rolling back company...');\n          await supabaseService.from('companies').delete().eq('id', createdCompany.id);\n        }\n\n        console.log('✅ Rollback completed');\n      } catch (rollbackError) {\n        console.error('❌ Rollback failed:', rollbackError);\n      }\n      \n      throw error;\n    }\n  }\n\n  /**\n   * Get all companies with owner information and email from auth.users\n   */\n  static async getAllCompanies() {\n    try {\n      // Get companies and find owners via profiles table\n      const { data: companies, error } = await supabase\n        .from('companies')\n        .select(`\n          id,\n          name,\n          created_at\n        `)\n        .order('created_at', { ascending: false });\n\n      if (error) {\n        console.error('❌ Error fetching companies:', error);\n        throw error;\n      }\n\n      // For each company, find the owner (profile with role = 'OWNER')\n      const companiesWithOwners = await Promise.all(\n        (companies || []).map(async (company) => {\n          try {\n            // Find owner profile for this company\n            const { data: ownerProfile, error: profileError } = await supabase\n              .from('profiles')\n              .select('id, full_name, phone')\n              .eq('company_id', company.id)\n              .eq('role', 'OWNER')\n              .single();\n\n            if (profileError && profileError.code !== 'PGRST116') {\n              console.error('Error fetching owner profile:', profileError);\n            }\n\n            // Get owner email from auth.users if we have an owner\n            let ownerEmail = 'N/A';\n            if (ownerProfile?.id) {\n              try {\n                const { data: authUser } = await supabaseAdmin.auth.admin.getUserById(ownerProfile.id);\n                ownerEmail = authUser?.user?.email || 'N/A';\n              } catch (error) {\n                console.error('Error fetching owner email:', error);\n              }\n            }\n\n            return {\n              ...company,\n              owner_profile: ownerProfile,\n              owner_email: ownerEmail\n            };\n          } catch (error) {\n            console.error('Error processing company:', error);\n            return {\n              ...company,\n              owner_profile: null,\n              owner_email: 'N/A'\n            };\n          }\n        })\n      );\n\n      return companiesWithOwners;\n    } catch (error) {\n      console.error('❌ Failed to fetch companies:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get company details with owner and employees, including emails from auth.users\n   */\n  static async getCompanyDetails(companyId) {\n    try {\n      const { data: company, error } = await supabase\n        .from('companies')\n        .select(`\n          id,\n          name,\n          created_at,\n          owner_profile_id,\n          owner_profile:profiles!owner_profile_id (\n            id,\n            full_name,\n            phone\n          ),\n          employees:profiles!company_id (\n            id,\n            full_name,\n            role,\n            phone,\n            created_at\n          )\n        `)\n        .eq('id', companyId)\n        .single();\n\n      if (error) {\n        console.error('❌ Error fetching company details:', error);\n        throw error;\n      }\n\n      // Get owner email\n      let ownerEmail = 'N/A';\n      if (company.owner_profile?.id) {\n        try {\n          const { data: authUser } = await supabaseAdmin.auth.admin.getUserById(company.owner_profile.id);\n          ownerEmail = authUser?.user?.email || 'N/A';\n        } catch (error) {\n          console.error('Error fetching owner email:', error);\n        }\n      }\n\n      // Get employee emails\n      const employeesWithEmails = await Promise.all(\n        (company.employees || []).map(async (employee) => {\n          try {\n            const { data: authUser } = await supabaseAdmin.auth.admin.getUserById(employee.id);\n            return {\n              ...employee,\n              email: authUser?.user?.email || 'N/A'\n            };\n          } catch (error) {\n            console.error('Error fetching employee email:', error);\n            return {\n              ...employee,\n              email: 'N/A'\n            };\n          }\n        })\n      );\n\n      return {\n        ...company,\n        owner_email: ownerEmail,\n        employees: employeesWithEmails\n      };\n    } catch (error) {\n      console.error('❌ Failed to fetch company details:', error);\n      throw error;\n    }\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}